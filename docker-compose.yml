services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    image: fcg.gameservice.api:latest
    container_name: FCGGameService-api
    restart: unless-stopped
    ports:
      - "8080:8080"   # HTTP
    environment:
      DOTNET_USE_POLLING_FILE_WATCHER: "1"
      DOTNET_RUNNING_IN_CONTAINER: "true"
      DOTNET_SYSTEM_GLOBALIZATION_INVARIANT: "false"
      ASPNETCORE_ENVIRONMENT: "Development"
      MongoDbSettings__ConnectionString: ""
      MongoDbSettings__DatabaseName: ""
      ElasticSettings__ApiKey: ""
      ElasticSettings__CloudId: ""
      AzureStorage__ConnectionString: ""
      AzureStorage__ProducerQueueName: ""
      AzureStorage__ConsumerQueueName: ""
    healthcheck:
      test: ["CMD-SHELL", "curl -f -sS http://localhost:8080/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 20s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    networks:
      - fcg_network

networks:
  fcg_network:
    driver: bridge